<div class="module-card">
  <h3>🗂️ Data Entry Tracker</h3>
  <div class="form-row">
    <input id="deDate" type="date" />
    <input id="deProject" placeholder="Project name" />
    <input id="deRecords" type="number" placeholder="Records entered" />
    <input id="deErrors" type="number" placeholder="Errors made" />
    <button id="addDE" class="btn">➕ Add</button>
  </div>

  <table id="deTable"><thead><tr><th>Date</th><th>Project</th><th>Records</th><th>Errors</th><th>Accuracy</th><th>Action</th></tr></thead><tbody id="deBody"></tbody></table>

  <div class="module-actions">
    <button id="exportDE" class="btn">⬇️ Export CSV</button>
    <button id="resetDE" class="btn">🔄 Reset</button>
  </div>
</div>

<script>
(function init_dataentry(){
  let rows = JSON.parse(localStorage.getItem('mod_dataentry')||'[]');
  const body = document.getElementById('deBody');

  function render(){ body.innerHTML = rows.map((r,i)=>`<tr><td>${r.date}</td><td>${r.project}</td><td>${r.records}</td><td>${r.errors}</td><td>${r.accuracy}%</td><td><button onclick="delDE(${i})">Delete</button></td></tr>`).join(''); }
  window.delDE = function(i){ rows.splice(i,1); save(); }
  function save(){ localStorage.setItem('mod_dataentry',JSON.stringify(rows)); render(); }

  document.getElementById('addDE').addEventListener('click', ()=>{ const d=document.getElementById('deDate').value || new Date().toISOString().slice(0,10), p=document.getElementById('deProject').value, rec=Number(document.getElementById('deRecords').value||0), err=Number(document.getElementById('deErrors').value||0); if(!p) return alert('Project name'); const acc = rec? Math.max(0,(((rec-err)/rec)*100).toFixed(1)) : 0; rows.push({date:d,project:p,records:rec,errors:err,accuracy:acc}); save(); });

  document.getElementById('exportDE').addEventListener('click', ()=>{ if(!rows.length) return alert('No data'); const csv='Date,Project,Records,Errors,Accuracy\\n'+rows.map(r=>`${r.date},${r.project},${r.records},${r.errors},${r.accuracy}`).join('\\n'); const b=new Blob([csv],{type:'text/csv'}); const a=document.createElement('a'); a.href=URL.createObjectURL(b); a.download='dataentry.csv'; a.click(); });

  document.getElementById('resetDE').addEventListener('click', ()=>{ if(confirm('Reset data entry records?')){ rows=[]; save(); }});
  render();
})();
</script>
